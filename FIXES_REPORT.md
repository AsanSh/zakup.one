# –û–¢–ß–ï–¢ –û–ë –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø–• - ZAKUP.ONE

## –î–∞—Ç–∞: 2025-12-29

## –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ï –ü–†–û–ë–õ–ï–ú–´

### 1. –û–®–ò–ë–ö–ò 500 –ò "–ù–ï –£–î–ê–õ–û–°–¨ –ó–ê–ì–†–£–ó–ò–¢–¨"

#### Backend:
- **–§–∞–π–ª**: `/opt/zakup/backend/apps/orders/serializers.py`
  - –î–æ–±–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ `get_total_amount()` –≤ `OrderSerializer` —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫
  - –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `installment` –≤ `OrderSerializer`
  - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è —Ç—Ä–µ–∫–∏–Ω–≥–∞ (—Ç–µ–ø–µ—Ä—å —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —Å–º–µ–Ω–µ —Å—Ç–∞—Ç—É—Å–∞ –Ω–∞ PAID)

- **–§–∞–π–ª**: `/opt/zakup/backend/apps/orders/views.py`
  - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω `DeliveryTrackingViewSet.get_queryset()` - –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
  - –î–æ–±–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –ø—Ä–∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ `order_id`

- **–§–∞–π–ª**: `/opt/zakup/backend/apps/orders/models.py`
  - –î–æ–±–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ `_create_tracking_if_available()` –≤ –º–æ–¥–µ–ª—å `Order`
  - –¢—Ä–µ–∫–∏–Ω–≥ —Å–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ —Å–º–µ–Ω–µ —Å—Ç–∞—Ç—É—Å–∞ –Ω–∞ PAID (–≤ –º–µ—Ç–æ–¥–µ `save()`)

- **–§–∞–π–ª**: `/opt/zakup/backend/apps/users/serializers.py`
  - –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `delivery_tracking_available` –≤ `SubscriptionPlanSerializer`

#### Frontend:
- **–§–∞–π–ª**: `/opt/zakup/frontend/src/pages/OrdersPage.tsx`
  - –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≤ `loadOrders()` —Å –¥–µ—Ç–∞–ª—å–Ω—ã–º–∏ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏
  - –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –º–∞—Å—Å–∏–≤ –ø–µ—Ä–µ–¥ —É—Å—Ç–∞–Ω–æ–≤–∫–æ–π —Å–æ—Å—Ç–æ—è–Ω–∏—è

- **–§–∞–π–ª**: `/opt/zakup/frontend/src/pages/SubscriptionPage.tsx`
  - –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≤ `loadData()` —Å fallback –∑–Ω–∞—á–µ–Ω–∏—è–º–∏
  - –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –º–∞—Å—Å–∏–≤ –¥–ª—è –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö

- **–§–∞–π–ª**: `/opt/zakup/frontend/src/pages/TrackingPage.tsx`
  - –ü–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∞–Ω–∞ –ª–æ–≥–∏–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç—Ä–µ–∫–∏–Ω–≥–∞
  - –†–∞–∑–¥–µ–ª–µ–Ω–∞ –∑–∞–≥—Ä—É–∑–∫–∞ –∑–∞–∫–∞–∑–∞ –∏ —Ç—Ä–µ–∫–∏–Ω–≥–∞ –¥–ª—è –ª—É—á—à–µ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫
  - –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ–ø–ª–∞—Ç—ã –ø–µ—Ä–µ–¥ –ø–æ–∫–∞–∑–æ–º —Ç—Ä–µ–∫–∏–Ω–≥–∞

### 2. –°–¢–†–ê–ù–ò–¶–ê –¢–†–ï–ö–ò–ù–ì–ê /tracking/:orderId

#### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
- **–§–∞–π–ª**: `/opt/zakup/frontend/src/pages/TrackingPage.tsx`
  - –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Ç–µ–ø–µ—Ä—å –≤—Å–µ–≥–¥–∞ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è
  - –ï—Å–ª–∏ –∑–∞–∫–∞–∑ –Ω–µ –æ–ø–ª–∞—á–µ–Ω - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
  - –ï—Å–ª–∏ –∑–∞–∫–∞–∑ –æ–ø–ª–∞—á–µ–Ω - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ–ª–Ω—ã–π —Ç—Ä–µ–∫–∏–Ω–≥
  - –£–ª—É—á—à–µ–Ω–∞ –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å (–º–æ–±–∏–ª—å–Ω–∞—è/–¥–µ—Å–∫—Ç–æ–ø–Ω–∞—è –≤–µ—Ä—Å–∏–∏)
  - –î–æ–±–∞–≤–ª–µ–Ω—ã –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Ç—Ä–µ–∫–∏–Ω–≥–∞ (üìç/üîí)

- **–§–∞–π–ª**: `/opt/zakup/frontend/src/pages/OrdersPage.tsx`
  - –î–æ–±–∞–≤–ª–µ–Ω—ã –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã —Ç—Ä–µ–∫–∏–Ω–≥–∞ –≤ —Å–ø–∏—Å–∫–µ –∑–∞–∫–∞–∑–æ–≤
  - –ù–æ–º–µ—Ä –∑–∞–∫–∞–∑–∞ –∫–ª–∏–∫–∞–±–µ–ª–µ–Ω –∏ –≤–µ–¥–µ—Ç –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É —Ç—Ä–µ–∫–∏–Ω–≥–∞

- **–§–∞–π–ª**: `/opt/zakup/backend/apps/orders/models.py`
  - –¢—Ä–µ–∫–∏–Ω–≥ —Å–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ —Å–º–µ–Ω–µ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–∫–∞–∑–∞ –Ω–∞ PAID
  - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –Ω–∞–ª–∏—á–∏–µ –∞–∫—Ç–∏–≤–Ω–æ–π –ø–æ–¥–ø–∏—Å–∫–∏ —Å `delivery_tracking_available = true`

### 3. –ê–î–ê–ü–¢–ò–í–ù–´–ô –î–ò–ó–ê–ô–ù

#### –û–±—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è:
- –í—Å–µ –∫–∞—Ä—Ç–æ—á–∫–∏: `rounded-lg` ‚Üí `rounded-2xl`
- –í—Å–µ –≥—Ä–∞–Ω–∏—Ü—ã: `border-gray-200` ‚Üí `border-slate-200`
- –î–æ–±–∞–≤–ª–µ–Ω—ã `break-words`, `truncate`, `min-w-0` –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –≤—ã—Ö–æ–¥–∞ —Ç–µ–∫—Å—Ç–∞
- –£–ª—É—á—à–µ–Ω–∞ –º–æ–±–∏–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è –≤—Å–µ—Ö —Å—Ç—Ä–∞–Ω–∏—Ü

#### –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ñ–∞–π–ª—ã:
- **CartPage.tsx**:
  - –ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è —Å–µ—Ç–∫–∞ –¥–ª—è —Ç–æ–≤–∞—Ä–æ–≤ (flex-col –Ω–∞ –º–æ–±–∏–ª–∫–µ, flex-row –Ω–∞ –¥–µ—Å–∫—Ç–æ–ø–µ)
  - –£–ª—É—á—à–µ–Ω–∞ —Ñ–æ—Ä–º–∞ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞
  - –î–æ–±–∞–≤–ª–µ–Ω `max-h` –∏ `overflow-y-auto` –¥–ª—è —Ñ–æ—Ä–º—ã

- **OrdersPage.tsx**:
  - –ú–æ–±–∏–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è: –∫–∞—Ä—Ç–æ—á–∫–∏ —Å –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–º —Ç–µ–∫—Å—Ç–æ–º
  - –î–µ—Å–∫—Ç–æ–ø–Ω–∞—è –≤–µ—Ä—Å–∏—è: —Ç–∞–±–ª–∏—Ü–∞ —Å sticky header –∏ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–º —Å–∫—Ä–æ–ª–ª–æ–º
  - –í—Å–µ —Ç–µ–∫—Å—Ç—ã —Å `truncate` –∏ `title` –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è

- **TrackingPage.tsx**:
  - –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π —Ç–∞–π–º–ª–∞–π–Ω (–≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–π –Ω–∞ –º–æ–±–∏–ª–∫–µ)
  - –£–ª—É—á—à–µ–Ω—ã –∫–∞—Ä—Ç–æ—á–∫–∏ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –∑–∞–∫–∞–∑–µ
  - –î–æ–±–∞–≤–ª–µ–Ω—ã `break-words` –¥–ª—è –¥–ª–∏–Ω–Ω—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤

- **CheckoutForm.tsx**:
  - –£–ª—É—á—à–µ–Ω–∞ —Ñ–æ—Ä–º–∞ –≤—ã–±–æ—Ä–∞ –∫–æ–º–ø–∞–Ω–∏–∏
  - –î–æ–±–∞–≤–ª–µ–Ω–∞ –∑–∞–≥—Ä—É–∑–∫–∞ –ø–æ–ª–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∫–æ–º–ø–∞–Ω–∏–∏ –ø—Ä–∏ –≤—ã–±–æ—Ä–µ
  - –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –ø–æ–ª—è –≤–≤–æ–¥–∞

### 4. –ë–ò–ó–ù–ï–°-–õ–û–ì–ò–ö–ê

#### –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞:
- **–§–∞–π–ª**: `/opt/zakup/backend/apps/orders/serializers.py`
  - –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ `user_company_id` –∏ `saved_company_id`
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Å—á–µ—Ç–æ–≤ –ø—Ä–∏ `payment_type = 'with_invoice'`
  - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ `installment` —Ñ–ª–∞–≥–∞

#### –¢—Ä–µ–∫–∏–Ω–≥:
- –¢—Ä–µ–∫–∏–Ω–≥ —Å–æ–∑–¥–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è –æ–ø–ª–∞—á–µ–Ω–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –Ω–∞–ª–∏—á–∏–µ –∞–∫—Ç–∏–≤–Ω–æ–π –ø–æ–¥–ø–∏—Å–∫–∏ —Å –¥–æ—Å—Ç—É–ø–æ–º –∫ —Ç—Ä–µ–∫–∏–Ω–≥—É
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏ —Å–º–µ–Ω–µ —Å—Ç–∞—Ç—É—Å–∞ –Ω–∞ PAID

#### –†–∞—Å—Å—Ä–æ—á–∫–∞:
- –î–æ—Å—Ç—É–ø–Ω–∞ —Ç–æ–ª—å–∫–æ –¥–ª—è VIP –ø–æ–¥–ø–∏—Å–∫–∏
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è `company.orders_count >= 5`
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –µ—Å–ª–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞

### 5. –û–ë–†–ê–ë–û–¢–ö–ê –û–®–ò–ë–û–ö

#### –£–ª—É—á—à–µ–Ω–∏—è:
- –í—Å–µ API –∑–∞–ø—Ä–æ—Å—ã —Ç–µ–ø–µ—Ä—å –∏–º–µ—é—Ç –¥–µ—Ç–∞–ª—å–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫
- –ü–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –ø–æ–Ω—è—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
- –î–æ–±–∞–≤–ª–µ–Ω—ã –∫–æ–¥—ã –æ—à–∏–±–æ–∫ –≤ —Å–æ–æ–±—â–µ–Ω–∏—è
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–Ω—Å–æ–ª—å –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

## –ö–û–ú–ê–ù–î–´ –î–õ–Ø –ü–†–ò–ú–ï–ù–ï–ù–ò–Ø –ò–ó–ú–ï–ù–ï–ù–ò–ô

```bash
# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ backend
cd /opt/zakup/infra
docker compose restart backend

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∏–≥—Ä–∞—Ü–∏–π (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
docker compose exec backend python manage.py makemigrations
docker compose exec backend python manage.py migrate

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤
docker compose logs backend --tail=50
```

## –ü–†–û–í–ï–†–ï–ù–ù–´–ï –°–¶–ï–ù–ê–†–ò–ò

1. ‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ —Å–ø–∏—Å–∫–∞ –∑–∞–∫–∞–∑–æ–≤ (`/api/orders/`)
2. ‚úÖ –û—Ç–∫—Ä—ã—Ç–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Ç—Ä–µ–∫–∏–Ω–≥–∞ (`/tracking/:orderId`)
3. ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞ —Å —Å—á–µ—Ç–æ–º
4. ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞ –±–µ–∑ —Å—á–µ—Ç–∞
5. ‚úÖ –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç—Ä–µ–∫–∏–Ω–≥–∞ –¥–ª—è –æ–ø–ª–∞—á–µ–Ω–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤
6. ‚úÖ –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Ç—Ä–µ–∫–∏–Ω–≥–∞ –¥–ª—è –Ω–µ–æ–ø–ª–∞—á–µ–Ω–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤
7. ‚úÖ –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö
8. ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ API

## –§–ê–ô–õ–´ –° –ò–ó–ú–ï–ù–ï–ù–ò–Ø–ú–ò

### Backend:
1. `/opt/zakup/backend/apps/orders/serializers.py`
2. `/opt/zakup/backend/apps/orders/views.py`
3. `/opt/zakup/backend/apps/orders/models.py`
4. `/opt/zakup/backend/apps/users/serializers.py`

### Frontend:
1. `/opt/zakup/frontend/src/pages/OrdersPage.tsx`
2. `/opt/zakup/frontend/src/pages/TrackingPage.tsx`
3. `/opt/zakup/frontend/src/pages/CartPage.tsx`
4. `/opt/zakup/frontend/src/pages/SubscriptionPage.tsx`
5. `/opt/zakup/frontend/src/components/CheckoutForm.tsx`

## –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò (–†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò)

1. –î–æ–±–∞–≤–∏—Ç—å unit-—Ç–µ—Å—Ç—ã –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö endpoints
2. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –æ—Ç–ø—Ä–∞–≤–∫—É email –¥–ª—è —Å—á–µ—Ç–æ–≤
3. –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ –¥–ª—è –≤—Å–µ—Ö —Ñ–æ—Ä–º
4. –£–ª—É—á—à–∏—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∑–∞–ø—Ä–æ—Å–æ–≤ (–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è queryset)
5. –î–æ–±–∞–≤–∏—Ç—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è —á–∞—Å—Ç–æ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö



